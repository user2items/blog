(self.webpackChunkwall_blog=self.webpackChunkwall_blog||[]).push([[92],{9539:(e,t,r)=>{"use strict";Object.defineProperty(t,"X",{value:!0});var n=s(r(94942)),o=s(r(36803));function s(e){return e&&e.__esModule?e:{default:e}}t.Z={props:["info"],components:{},data:function(){return{roles:[{label:"超级管理员",value:"admin"},{label:"普通管理员",value:"default"}],loading:!1,dialogTableVisible:!0,rules:{username:[{required:!0,message:"请填写用户名",trigger:"blur"}],old_pwd:[{required:!0,message:"请填写原密码",trigger:"blur"}],pwd:[{required:!0,message:"请填写密码",trigger:"blur"}],roles:[{required:!0,message:"请选择权限",trigger:"change",type:"array"}]}}},methods:{close:function(){this.$emit("close")},handleSubmit:function(e){var t,r=this;this.loading=!0,this.$refs[e].validate((t=(0,o.default)(n.default.mark((function e(t){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=19;break}return e.prev=1,delete r.info.createTime,delete r.info.releaseTime,e.next=6,r.$store.dispatch("updateUser",r.info);case 6:r.loading=!1,r.$message.success("编辑成功"),r.close(),e.next=17;break;case 11:e.prev=11,e.t0=e.catch(1),r.info.pwd="",r.info.old_pwd="",r.loading=!1,r.$message.error("编辑失败");case 17:e.next=22;break;case 19:return console.log("error submit!!"),r.loading=!1,e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e,r,[[1,11]])}))),function(e){return t.apply(this,arguments)}))}}}},81961:(e,t,r)=>{"use strict";Object.defineProperty(t,"X",{value:!0});var n=c(r(94942)),o=c(r(36803)),s=c(r(88239)),l=c(r(42152)),a=c(r(14973)),i=r(20629);function c(e){return e&&e.__esModule?e:{default:e}}t.Z={components:{editDialog:a.default},computed:(0,s.default)({},(0,i.mapGetters)(["userList","userTotal"])),data:function(){return{listLoading:!1,editShow:!1,searchForm:{keyword:""},userInfo:{},columns:[{label:"_id",prop:"_id",slot:"_id"},{label:"用户名",prop:"username"},{label:"权限",prop:"roles",slot:"roles"},{label:"操作",slot:"operate",width:"150"}]}},mounted:function(){this.requestPageData=this.getUserList,this.getUserList()},methods:{getUserList:function(){var e=this;return(0,o.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.listLoading=!0,t.prev=1,t.next=4,e.$store.dispatch("getUserList",{keyword:e.searchForm.keyword,pageindex:e.pageInfo.pageNum,pagesize:e.pageInfo.pageSize});case 4:e.listLoading=!1,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),e.listLoading=!1;case 10:case"end":return t.stop()}}),t,e,[[1,7]])})))()},handleCopyId:function(){var e=this,t=new l.default(".clipboardBtn");t.on("success",(function(r){e.$message.success("复制成功"),t.destroy()})),t.on("error",(function(r){e.$message.error("该浏览器不支持自动复制"),t.destroy()}))},handleClose:function(){this.editShow=!1},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((0,o.default)(n.default.mark((function r(){return n.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$store.dispatch("delUser",e._id);case 3:t.$message.success("删除成功"),t.getUserList(),r.next=11;break;case 7:r.prev=7,r.t0=r.catch(0),t.$message.error("删除失败"),console.log(r.t0);case 11:case"end":return r.stop()}}),r,t,[[0,7]])})))).catch((function(){t.$message.info("已取消删除")}))},handleEdit:function(e){this.editShow=!0,e.releaseTime=new Date(e.releaseTime),this.userInfo=e}}}},81572:(e,t,r)=>{(e.exports=r(9252)(!1)).push([e.id,"/**\n * 变量样式\n */\n.el-form .el-form-item[data-v-0fc01e15] {\n  display: flex;\n  align-items: center;\n}\n.el-form .el-form-item[data-v-0fc01e15] .el-form-item__label {\n  min-width: 80px;\n}\n.el-form .el-form-item[data-v-0fc01e15] .el-form-item__content {\n  margin-left: 0 !important;\n  width: 260px;\n}\n.el-form .el-form-item[data-v-0fc01e15] .el-form-item__content .el-select {\n  width: 260px;\n}\n",""])},71587:(e,t,r)=>{(e.exports=r(9252)(!1)).push([e.id,"/**\n * 变量样式\n */\n.tag[data-v-e19116b4] {\n  margin: 0 10px;\n}\n",""])},14973:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__esModule:()=>n.X,default:()=>s});var n=r(9539);const o=n.Z;r(79040);const s=(0,r(51900).Z)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("zp-dialog",e._g(e._b({attrs:{title:"管理员编辑",visible:e.dialogTableVisible,width:"480px","destroy-on-close":!0},on:{"update:visible":function(t){e.dialogTableVisible=t},close:e.close}},"zp-dialog",e.$attrs,!1),e.$listeners),[r("el-form",{ref:"form",attrs:{model:e.info,rules:e.rules}},[r("el-form-item",{attrs:{label:"用户名：",prop:"username"}},[r("el-input",{attrs:{type:"text"},model:{value:e.info.username,callback:function(t){e.$set(e.info,"username",t)},expression:"info.username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"原密码：",prop:"old_pwd"}},[r("el-input",{attrs:{type:"password"},model:{value:e.info.old_pwd,callback:function(t){e.$set(e.info,"old_pwd",t)},expression:"info.old_pwd"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"新密码：",prop:"pwd"}},[r("el-input",{attrs:{type:"password"},model:{value:e.info.pwd,callback:function(t){e.$set(e.info,"pwd",t)},expression:"info.pwd"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"权限：",prop:"roles"}},[r("el-select",{staticClass:"block",attrs:{multiple:"",placeholder:"请选择"},model:{value:e.info.roles,callback:function(t){e.$set(e.info,"roles",t)},expression:"info.roles"}},e._l(e.roles,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.close}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.handleSubmit("form")}}},[e._v("\n      确定\n    ")])],1)],1)}),[],!1,null,"0fc01e15",null).exports},24092:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__esModule:()=>n.X,default:()=>s});var n=r(81961);const o=n.Z;r(5997);const s=(0,r(51900).Z)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"article-list"},[r("zp-page-list",{scopedSlots:e._u([{key:"header",fn:function(){return[r("span",[e._v("管理员列表")])]},proxy:!0}])},[e._v(" "),r("div",{attrs:{slot:"filter"},slot:"filter"},[r("el-form",{ref:"searchForm",staticClass:"zp-search-form",attrs:{inline:!0,model:e.searchForm}},[r("el-form-item",{attrs:{label:"关键词：",prop:"keyword"}},[r("el-input",{attrs:{placeholder:"请输入用户名"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getUserList.apply(null,arguments)}},model:{value:e.searchForm.keyword,callback:function(t){e.$set(e.searchForm,"keyword",t)},expression:"searchForm.keyword"}})],1),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.getUserList}},[e._v(" 查询 ")])],1)],1),e._v(" "),r("div",{attrs:{slot:"list"},slot:"list"},[r("zp-table-list",{attrs:{loading:e.listLoading,source:e.userList,count:e.userTotal,columns:e.columns},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange},scopedSlots:e._u([{key:"_id",fn:function(t){return[r("el-button",{staticClass:"clipboardBtn",attrs:{icon:"el-icon-document-copy",type:"primary",size:"mini","data-clipboard-text":t.row._id},on:{click:e.handleCopyId}},[e._v("复制\n          ")])]}},{key:"roles",fn:function(t){return e._l(t.row.roles,(function(t,n){return r("el-tag",{key:n,staticClass:"tag",attrs:{type:"primary","close-transition":""}},[e._v(e._s(t))])}))}},{key:"operate",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(r){return e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1)]),e._v(" "),e.editShow?r("editDialog",{attrs:{info:e.userInfo},on:{close:e.handleClose}}):e._e()],1)}),[],!1,null,"e19116b4",null).exports},79040:(e,t,r)=>{var n=r(81572);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,r(45346).Z)("1742b534",n,!0,{})},5997:(e,t,r)=>{var n=r(71587);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,r(45346).Z)("40c87e12",n,!0,{})}}]);